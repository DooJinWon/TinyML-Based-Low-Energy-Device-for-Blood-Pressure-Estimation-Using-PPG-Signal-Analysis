## Repository Structure and Code Description

This repository contains scripts for preprocessing PPG data, training a neural network model, and converting the trained model into a format suitable for TinyML deployment on embedded devices.

### File Overview

#### `preprocessing.py`
This script handles preprocessing of raw PPG waveform data.  
It performs operations such as filtering, normalization, segmentation, and preparation of input windows for model training.  
The output of this script is cleaned and structured data suitable for neural network input.

---

#### `train_onlycnn_beat.py`
This script is responsible for training the deep learning model using the preprocessed PPG data.  
It implements a convolutional neural networkâ€“based architecture designed to extract temporal features from PPG signals.  
The trained model is saved for later conversion and deployment.

---

#### `export_onnx.py`
This script exports the trained PyTorch model to the ONNX (Open Neural Network Exchange) format.  
ONNX serves as an intermediate representation that enables compatibility between different machine learning frameworks and is a key step in the deployment pipeline.

---

#### `convert_to_tflite.py`
This script converts the ONNX model into a TensorFlow Lite (TFLite) model.  
During this process, model optimizations such as quantization may be applied to reduce memory usage and improve inference efficiency on embedded systems.

---

#### `convert_to_header.py`
This script converts the TFLite model file into a C/C++ header file.  
The generated header contains the model weights as a byte array, allowing the model to be directly embedded into microcontroller firmware.

---

#### `waveform.py`
This script provides utilities for visualizing and inspecting PPG waveforms.  
It is mainly used for debugging, data inspection, and qualitative evaluation of signal quality before and after preprocessing.

---

## Model Conversion Pipeline

The overall model deployment pipeline is as follows:

1. Raw PPG data preprocessing (`preprocessing.py`)
2. Model training (`train_onlycnn_beat.py`)
3. Model export to ONNX (`export_onnx.py`)
4. Conversion to TensorFlow Lite (`convert_to_tflite.py`)
5. Conversion to C/C++ header for embedded deployment (`convert_to_header.py`)

This pipeline enables seamless transition from model development on a PC to deployment on a low-power embedded device.

---

## Notes

- The scripts are intended to be executed in sequence.
- Some scripts depend on the output files generated by previous steps.
- File paths and parameters may need to be adjusted depending on the dataset location and target hardware constraints.

